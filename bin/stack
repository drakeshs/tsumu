#!/usr/bin/env ruby
# ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../../Gemfile', __FILE__)
# load Gem.bin_path('bundler', 'bundle')

require 'aws-sdk'
require 'pry'
require 'yaml'
require 'hirb'
require 'thor'

PROJECT_ROOT = Pathname.new( __dir__ ).join("..")
require PROJECT_ROOT.join("lib/stack.rb")


class MyCLI < Thor

  desc "status ENV", "Stack Status for given environment"
  def status(environment)
    stack = Stack::Base.new( "staging" )
    stack.status
  end

  desc "install ENV", "Create given stack environment"
  def install(environment)
    stack = Stack::Base.new( "staging" )
    stack.create
  end

  desc "destroy ENV", "Destroy given stack environment"
  def destroy(environment)
    stack = Stack::Base.new( "staging" )
    stack.destroy
    stack.status
  end

  desc "bootstrap ENV application server", "Chef bootstrap given server in given environment"
  def bootstrap(environment, application, server)
    stack = Stack::Base.new( "staging" )
    stack.bootstrap(application, server)
  end


end

MyCLI.start(ARGV)


